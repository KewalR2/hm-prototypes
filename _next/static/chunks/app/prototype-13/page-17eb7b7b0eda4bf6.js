(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[650],{3639:(e,t,r)=>{Promise.resolve().then(r.bind(r,7391))},7391:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(5155),s=r(6874),n=r.n(s),i=r(3438);function o(e){let{enabled:t,onChange:r}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Claude API (Enabled by Default)"}),(0,a.jsx)("button",{type:"button",role:"switch","aria-checked":t,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-gray-900 ".concat(t?"bg-primary":"bg-gray-200 dark:bg-gray-700"),onClick:()=>r(!t),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(t?"translate-x-6":"translate-x-1")})}),(0,a.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:t?"AI Powered Responses":"Using Sample Data"})]})}var l=r(2115),d=r(3914);function c(){return(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 transition-colors",onClick:()=>alert("Voice input feature is not implemented in this prototype"),children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[(0,a.jsx)("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),(0,a.jsx)("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),(0,a.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),(0,a.jsx)("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),(0,a.jsx)("span",{children:"Voice Input"})]})}function m(e){let{isOpen:t,onClose:r,materials:s,allMaterials:n=[],selectedMaterials:i,onConfirm:o}=e,[d,c]=(0,l.useState)([]),[m,u]=(0,l.useState)("");(0,l.useEffect)(()=>{t&&c(i)},[t,i]);let g=e=>{d.includes(e)?c(d.filter(t=>t!==e)):c([...d,e])};if(!t)return null;let p=e=>{let t=e.name.toLowerCase(),r=e.id.toLowerCase();return t.includes("concrete")||r.includes("conc")?"cubic yard":t.includes("brick")||r.includes("brick")?"pcs":t.includes("pipe")||r.includes("pipe")?"linear ft":t.includes("block")||r.includes("block")?"pcs":t.includes("sand")||t.includes("soil")||r.includes("sand")?"cubic yard":t.includes("aggregate")||t.includes("gravel")||r.includes("agg")||t.includes("asphalt")||r.includes("asph")||t.includes("rebar")||t.includes("steel")||r.includes("rebar")?"ton":"unit"},y=s.reduce((e,t)=>{let r="General",a=t.id.toLowerCase(),s=t.name.toLowerCase();return a.startsWith("conc")||s.includes("concrete")?r="Concrete":a.startsWith("agg")||s.includes("aggregate")||s.includes("gravel")?r="Aggregates":a.startsWith("asph")||s.includes("asphalt")?r="Asphalt":a.startsWith("struct")||s.includes("steel")||s.includes("rebar")?r="Structural":a.startsWith("mason")||s.includes("brick")||s.includes("block")?r="Masonry":(a.startsWith("drain")||s.includes("pipe"))&&(r="Drainage"),e[r]||(e[r]=[]),e[r].push(t),e},{});return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-xl max-h-[80vh] flex flex-col transition-all transform animate-fade-in-up",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Select Materials"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("input",{type:"text",placeholder:"Search materials...",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:m,onChange:e=>u(e.target.value)})}),(0,a.jsx)("div",{className:"p-4 flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"Based on your project, we recommend the following materials. Please select the ones you want to include in your quote."}),(0,a.jsxs)("div",{className:"grid gap-3",children:[Object.entries(y).map(e=>{let[t,r]=e,s=m?r.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.id.toLowerCase().includes(m.toLowerCase())):r;return 0===s.length?null:(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:t}),(0,a.jsx)("div",{className:"grid gap-2",children:s.map(e=>(0,a.jsx)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"material-".concat(e.id),checked:d.includes(e.name),onChange:()=>g(e.name),className:"mr-3 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"}),(0,a.jsxs)("label",{htmlFor:"material-".concat(e.id),className:"flex-1 cursor-pointer",children:[(0,a.jsx)("div",{className:"font-medium dark:text-white",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Quantity: ".concat(e.quantity," ").concat(p(e))}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["ID: ",e.id]})]})]})},e.id))})]},t)}),0===Object.values(y).flat().filter(e=>!m||e.name.toLowerCase().includes(m.toLowerCase())||e.id.toLowerCase().includes(m.toLowerCase())).length&&(0,a.jsx)("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:"No materials found matching your search."})]})]})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Selected: ",(0,a.jsx)("span",{className:"font-medium",children:d.length})," materials"]}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)("button",{onClick:r,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{o(d.join(", ")),r()},className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:"Confirm"})]})]})]})})}function u(e){let{stepType:t}=e;return(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-6"}),(()=>{switch(t){case d.dZ.MATERIAL_SELECTION:return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded"},e))})]});case d.dZ.PLANT_SELECTION:return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-2"}),[1,2].map(e=>(0,a.jsx)("div",{className:"h-28 bg-gray-200 dark:bg-gray-700 rounded"},e))]});case d.dZ.BUDGET:return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-2"}),(0,a.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6].map(e=>(0,a.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"},e))})]});case d.dZ.CUSTOMER_INFO:return(0,a.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),(0,a.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"})]},e))});default:return(0,a.jsx)("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded mb-4"})}})(),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded w-24"}),(0,a.jsx)("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded w-24"})]})]})}function g(e){let{currentQuestion:t,onAnswer:r,onPrevious:s,isLoading:n,stepType:i,materials:o,plants:g,hasPrevious:p}=e,[y,h]=(0,l.useState)(""),[x,b]=(0,l.useState)(!1),v=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=v.current;e&&(e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px"))},[y]),(0,l.useEffect)(()=>{h("")},[i]);let f=i===d.dZ.MATERIAL_SELECTION&&o.length>0,N=i===d.dZ.PLANT_SELECTION&&g.length>0,j=i===d.dZ.BUDGET,k=i===d.dZ.CUSTOMER_INFO;return(0,a.jsx)("div",{className:"w-full max-w-2xl p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md transition-colors duration-200",children:n?(0,a.jsx)(u,{stepType:i}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:t}),f&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Recommended Materials:"}),(0,a.jsx)("button",{onClick:()=>b(!0),className:"text-xs text-primary hover:text-primary/80 font-medium",children:"View All Materials"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-2",children:o.slice(0,4).map((e,t)=>(0,a.jsx)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ".concat(y.includes(e.name)?"border-primary dark:border-primary":""),onClick:()=>{let t=y.split(",").map(e=>e.trim()).filter(Boolean);t.includes(e.name)?h(t.filter(t=>t!==e.name).join(", ")):h([...t,e.name].join(", "))},children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"mt-1",checked:y.includes(e.name),onChange:()=>{},onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium dark:text-white",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.category}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:[e.recommendedQuantity," ",e.unit]})]})]})},e.id))}),o.length>4&&(0,a.jsxs)("button",{onClick:()=>b(!0),className:"text-sm text-primary hover:text-primary/80 mt-1",children:["+ ",o.length-4," more materials"]}),(0,a.jsx)(m,{isOpen:x,onClose:()=>b(!1),materials:o.map(e=>({id:e.id,name:e.name,quantity:e.recommendedQuantity||0})),allMaterials:[],selectedMaterials:y?y.split(",").map(e=>e.trim()).filter(Boolean):[],onConfirm:h})]}),N&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Recommended Suppliers:"}),(0,a.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,a.jsx)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ".concat(y.includes(e.plant.name)?"border-primary dark:border-primary":""," ").concat(e.isRecommended?"bg-blue-50 dark:bg-blue-900/20":""),onClick:()=>{let t=y.split(",").map(e=>e.trim()).filter(Boolean);t.includes(e.plant.name)?h(t.filter(t=>t!==e.plant.name).join(", ")):h([...t,e.plant.name].join(", "))},children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"mt-1",checked:y.includes(e.plant.name),onChange:()=>{},onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium dark:text-white",children:e.plant.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.plant.location.address," (",e.distance," miles)"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Transport cost: ~$",e.transportCost.toFixed(2)]}),e.isRecommended&&e.reasonForRecommendation&&(0,a.jsx)("div",{className:"text-xs text-primary mt-1",children:e.reasonForRecommendation})]})]})},e.plant.id))})]}),j&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What's your budget for these materials?"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute top-1/2 -translate-y-1/2 left-3 text-gray-500",children:"$"}),(0,a.jsx)("input",{type:"text",value:y,onChange:e=>{h(e.target.value.replace(/[^0-9,.]/g,""))},className:"w-full p-2 pl-6 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter amount"})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[5e3,1e4,25e3,5e4,1e5,25e4].map(e=>(0,a.jsxs)("button",{type:"button",className:"p-2 border border-gray-200 dark:border-gray-700 rounded-md text-sm hover:bg-gray-50 dark:hover:bg-gray-700 ".concat(y===e.toString()?"bg-primary/10 border-primary":""),onClick:()=>h(e.toString()),children:["$",e.toLocaleString()]},e))})]}),k&&(0,a.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Your Name"}),(0,a.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Full name",value:y.split("|||")[0]||"",onChange:e=>{let t=y.split("|||");t[0]=e.target.value,h(t.join("|||"))}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company (optional)"}),(0,a.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Company name",value:y.split("|||")[1]||"",onChange:e=>{let t=y.split("|||");for(t[1]=e.target.value;t.length<3;)t.push("");h(t.join("|||"))}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Contact Information"}),(0,a.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Email or phone number",value:y.split("|||")[2]||"",onChange:e=>{let t=y.split("|||");for(t[2]=e.target.value;t.length<3;)t.push("");h(t.join("|||"))}})]})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y.trim()&&!n&&r(y.trim())},className:"space-y-4",children:[!f&&!N&&!j&&!k&&(0,a.jsx)("div",{children:i===d.dZ.DELIVERY_LOCATION?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Address"}),(0,a.jsx)("textarea",{ref:v,value:y.split("|||")[0]||"",onChange:e=>{let t=y.split("|||");for(t[0]=e.target.value;t.length<2;)t.push("");h(t.join("|||"))},className:"w-full p-3 border rounded-md dark:bg-gray-800 dark:border-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter the delivery address...",rows:3,disabled:n})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Preferred Delivery Date"}),(0,a.jsx)("input",{type:"date",value:y.split("|||")[1]||"",onChange:e=>{let t=y.split("|||");for(t[1]=e.target.value;t.length<2;)t.push("");h(t.join("|||"))},className:"w-full p-3 border rounded-md dark:bg-gray-800 dark:border-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",min:new Date().toISOString().split("T")[0],disabled:n})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Please provide the full delivery address and your preferred delivery date."})]}):(0,a.jsx)("textarea",{ref:v,value:y,onChange:e=>h(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"Type your answer here...",rows:3,disabled:n})}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex space-x-3 items-center",children:[(0,a.jsx)(c,{}),p&&(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:n,children:"Back"})]}),(0,a.jsx)("button",{type:"submit",className:"px-5 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors ".concat(n?"opacity-50 cursor-not-allowed":""),disabled:n||!y.trim()&&i!==d.dZ.CONFIRMATION,children:n?"Processing...":i===d.dZ.CONFIRMATION?"Complete Quote":"Next"})]})]})]})})}var p=r(849),y=r(6881);async function h(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];try{let s,n=function(e,t){var r,a,s;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=t.customer?JSON.stringify({name:t.customer.name,contact:t.customer.contactInfo,company:t.customer.company,expertiseLevel:t.customer.expertiseLevel}):"Data Not Provided",l=t.project?JSON.stringify({desc:t.project.description,type:t.project.projectType}):"Data Not Provided",d=n.length>0?JSON.stringify({materials:n.map(e=>({id:e.id,name:e.name,category:e.category,unit:e.unit,recommendedQuantity:e.recommendedQuantity}))}):"Data Not Provided",c=(null==(a=t.deliveryInfo)||null==(r=a.location)?void 0:r.address)?JSON.stringify({delivery:t.deliveryInfo.location.address,coordinates:t.deliveryInfo.location.coordinates}):"Data Not Provided",m=(null==(s=t.deliveryInfo)?void 0:s.budget)?JSON.stringify({budget:"$".concat(t.deliveryInfo.budget)}):"Data Not Provided",u=i.length>0?JSON.stringify({plants:i.map(e=>({id:e.plant.id,name:e.plant.name,location:e.plant.location,transportCostPerMile:e.plant.transportCostPerMile,materials:e.plant.materials}))}):"Data Not Provided";return'\nYou are an AI assistant helping with a heavy construction materials quote request system.\nOUTPUT Format:\nYou MUST output ONLY JSON in this EXACT format:\n{\n    "question": "Keep questions short. Only include essential information.", \n    "componentType": "'.concat(e,'", // MUST be one of: "customer_info", "project_info", "material_selection", "delivery_location", "budget", "plant_selection", "confirmation"\n    "materials": [], // Provide only when we are in material_selection step otherwise skip\n    "plants": [], // Provide only when we are in plant_selection step otherwise skip\n    "quote_type": "ALWAYS INCLUDE with specific project type like \'Highway Construction\', \'Road Construction\', \'Bridge Construction\', etc.",\n    "expertise_level": "ONLY analyze expertise level AFTER customer provides project_info, never during customer_info step. Valid values are: \'beginner\', \'intermediate\', or \'expert\'",\n    "project_summary": "When project_info is provided, include a 1-2 sentence technical summary of the project",\n    "costs": {}, // Provide only when we have selected materials and plants otherwise skip\n}\n\nPOPULATION FORMAT:\n\nmaterials[]:\nEach object must follow this format:\n{\n    "id": "material-id",\n    "name": "Material Name",\n    "category": "Category",\n    "unit": "Unit",\n    "basePrice": 50,\n    "description": "Brief description of the material",\n    "commonUses": ["Road base", "Foundation fill"],\n    "recommendedQuantity": 100,\n    "preferredPlantId": "plant-id" // OPTIONAL: For specific plant recommendation\n}\n\nplants[]:\nEach object must follow this format:\n{\n    "id": "plant-id",\n    "name": "Plant Name", // Must be descriptive and professional (e.g. "Northeast Concrete Supply")\n    "location": {\n        "address": "Physical address",\n        "coordinates": {\n            "lat": 30.0,\n            "lng": -97.0\n        }\n    },\n    "transportCostPerMile": 5,\n    "minDeliveryDistance": 0,\n    "maxDeliveryDistance": 100,\n    "tollZones": [],\n    "truckInfo": { // NEW: Include truck information\n        "vehicleType": "Heavy Duty", // e.g. "Heavy Duty", "Light Duty", "Crane Truck"\n        "plateNumber": "TR-1234", // A realistic truck identifier\n        "driverContact": "555-123-4567" // Driver\'s contact number\n    },\n    "deliveryVerification": { // NEW: Include delivery verification info\n        "otp": "123456", // A 6-digit OTP code for verification\n        "instructions": "Share OTP with driver upon delivery"\n    },\n    "materials": [\n        {\n            "materialId": "material-id",\n            "availability": "high",\n            "priceMultiplier": 1.0\n        }\n    ]\n}\n\ncosts{}:\n{\n    "materials": number, // calculate material\'s price based on selected entries\n    "transport_cost": number, // Generate Realtime value\n    "toll_cost": number,  // Generate Realtime value\n    "total_cost": number,  // Generate Realtime value\n}\n\nMANDATORY SEQUENCE (never skip or reorder):\n1. customer_info → Ask: "What\'s your name and contact information?" (componentType MUST be "customer_info")\n2. project_info → Ask: "Can you describe what you are trying to build?" (componentType MUST be "project_info")\n3. material_selection → IMMEDIATELY after project_info is answered, respond with recommended materials. Do NOT ask. Use this question: "Based on your [project type], here are the recommended materials. Are there any additional materials you need?" (componentType MUST be "material_selection")\n4. delivery_location → Ask: "Where and when should we deliver these materials? Please include your preferred delivery date." (componentType MUST be "delivery_location")\n5. budget → Ask: "What\'s your budget for this project?" (componentType MUST be "budget")\n6. plant_selection → IMPORTANT: Do NOT assign all materials to all plants. Each plant should specialize in specific materials only. Include truck and delivery verification info for each plant. Keep the question short and direct. (componentType MUST be "plant_selection")\n7. confirmation → Final message: "Thank you. Your quote has been generated and can be viewed in the sidebar." (componentType MUST be "confirmation")\n\nSTATE:\n1. customer_info: ').concat("Data Not Provided"!==o?o:"Data Not Provided","\n2. project_info: ").concat("Data Not Provided"!==l?l:"Data Not Provided","\n3. material_selection: ").concat("Data Not Provided"!==d?d:"Data Not Provided","\n4. delivery_location: ").concat("Data Not Provided"!==c?c:"Data Not Provided","\n5. budget: ").concat("Data Not Provided"!==m?m:"Data Not Provided","\n6. plant_selection: ").concat("Data Not Provided"!==u?u:"Data Not Provided","\n").trim()}(e,t,r,a),i=await fetch("/api/claude",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:n})});if(!i.ok)throw Error("API response error: ".concat(i.status));let o=await i.json();try{try{let e=o.text.trim(),t=e,r=(e.match(/{/g)||[]).length,a=(e.match(/}/g)||[]).length;r>a&&(console.warn("Detected incomplete JSON response, attempting to fix"),t=e+"}".repeat(r-a)),s=JSON.parse(t)}catch(e){throw console.error("Error parsing JSON even after repair attempt",e),Error("Invalid JSON response from Claude API")}if(!s.question||!s.componentType)throw Error("Invalid response format: missing question or componentType");console.log("Claude response:",s),[...Object.values(d.dZ),"text","options","customer_component","project_info_component"].includes(s.componentType)||console.warn('Unrecognized componentType "'.concat(s.componentType,'" in Claude response, might cause routing issues'))}catch(e){throw console.error("Failed to parse Claude response as JSON:",e),console.error("Raw response:",o.text),Error("Failed to parse Claude response: ".concat(e.message))}return s}catch(e){throw console.error("Error calling Claude API:",e),e}}let x=(0,i.PA)(()=>{let e=(0,y.$)(),t=async t=>{if(t.trim()&&!e.isLoading){e.setIsLoading(!0);try{let r;e.addToQuestionHistory({id:Date.now().toString(),question:e.currentQuestion,answer:t,stepType:e.currentStepType});let a=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s={...r};switch(e){case d.dZ.CUSTOMER_INFO:let n,i,o;if(t.includes("|||")){var l,c,m;let e=t.split("|||");n=(null==(l=e[0])?void 0:l.trim())||"",i=null==(c=e[1])?void 0:c.trim(),o=(null==(m=e[2])?void 0:m.trim())||n}else n=t.trim(),o=t.trim();n&&(s.customer={name:n,company:i,contactInfo:o||n,expertiseLevel:""});break;case d.dZ.PROJECT_INFO:s.project={description:t,projectType:"General Construction",summary:void 0};break;case d.dZ.MATERIAL_SELECTION:let u=t.split(",").map(e=>e.trim()).filter(Boolean);s.materials=[],u.forEach(e=>{let t=a.find(t=>t.name===e||t.name.toLowerCase()===e.toLowerCase());t&&s.materials.push({materialId:t.id,quantity:t.recommendedQuantity||0})});break;case d.dZ.DELIVERY_LOCATION:let g=t.split("|||"),p=g[0]||"",y=g[1]||"";s.deliveryInfo={...s.deliveryInfo||{},location:{address:p,coordinates:{lat:30.26+(Math.random()-.5)*2,lng:-97.74+(Math.random()-.5)*2}},preferredDate:y};break;case d.dZ.BUDGET:let h=parseFloat(t.replace(/[^0-9.]/g,""));s.deliveryInfo={...s.deliveryInfo||{},budget:isNaN(h)?1e4:h};break;case d.dZ.PLANT_SELECTION:let x=t.split(",").map(e=>e.trim()),b={};if(x.forEach((e,t)=>{b["plant-".concat(t+1)]=[]}),s.materials&&s.materials.length>0){let e=Object.keys(b);s.materials.forEach((t,r)=>{let a=r%e.length;b[e[a]].push(t.materialId)})}s.plantSelections=Object.entries(b).map(e=>{let[t,r]=e;return{plantId:t,materialIds:r}});break;case d.dZ.CONFIRMATION:s.status="submitted"}return s}(e.currentStepType,t,e.quoteRequest,e.recommendedMaterials);e.setQuoteRequest(a);try{e.useClaudeAPI?r=await h(e.currentStepType,e.quoteRequest,e.recommendedMaterials,e.recommendedPlants):(console.log("Claude API is disabled, using sample data..."),r=({[d.dZ.CUSTOMER_INFO]:{question:"Can you describe what you are trying to build?",componentType:"project_info"},[d.dZ.PROJECT_INFO]:{question:"Based on your Highway Construction project, here are the recommended materials. Are there any additional materials you need?",componentType:"material_selection",materials:[{id:"asphalt-concrete",name:"Asphalt Concrete",category:"Paving",unit:"Ton",basePrice:100,description:"A composite material commonly used for road surfaces",commonUses:["Road surface","Highway paving"],recommendedQuantity:5e4},{id:"crushed-stone",name:"Crushed Stone",category:"Aggregate",unit:"Ton",basePrice:30,description:"Used for road base and drainage",commonUses:["Road base","Drainage"],recommendedQuantity:75e3},{id:"reinforced-concrete",name:"Reinforced Concrete",category:"Structural",unit:"Cubic Yard",basePrice:150,description:"For bridges, culverts, and other structures",commonUses:["Bridges","Culverts","Drainage structures"],recommendedQuantity:1e4},{id:"geotextile-fabric",name:"Geotextile Fabric",category:"Erosion Control",unit:"Square Yard",basePrice:2,description:"Used for soil stabilization and drainage",commonUses:["Soil stabilization","Drainage improvement"],recommendedQuantity:1e5}],quote_type:"Highway Construction"},[d.dZ.MATERIAL_SELECTION]:{question:"Where should we deliver these materials?",componentType:"delivery_location",quote_type:"Highway Construction"},[d.dZ.DELIVERY_LOCATION]:{question:"What's your budget for this project?",componentType:"budget",quote_type:"Highway Construction"},[d.dZ.BUDGET]:{question:"Based on your materials and location, here are the recommended suppliers. Which would you prefer to work with?",componentType:"plant_selection",quote_type:"Highway Construction",plants:[{id:"plant-midwest-01",name:"Midwest Asphalt Supply",location:{address:"1234 Industrial Blvd, Kansas City, KS 66101",coordinates:{lat:39.115,lng:-94.626}},transportCostPerMile:4.5,minDeliveryDistance:0,maxDeliveryDistance:150,tollZones:[],materials:[{materialId:"asphalt-concrete",availability:"high",priceMultiplier:1}]},{id:"plant-central-02",name:"Central Materials Depot",location:{address:"4500 Main Industrial Parkway",coordinates:{lat:30.25,lng:-97.75}},transportCostPerMile:4.25,minDeliveryDistance:0,maxDeliveryDistance:100,tollZones:[],materials:[{materialId:"crushed-stone",availability:"high",priceMultiplier:.95}]}]},[d.dZ.PLANT_SELECTION]:{question:"Thank you. Your quote has been generated and can be viewed in the sidebar.",componentType:"confirmation",quote_type:"Highway Construction",costs:{materials:85e5,transport_cost:125e3,toll_cost:15e3,total_cost:864e4}},[d.dZ.CONFIRMATION]:{question:"What's your name and contact information?",componentType:"customer_info",quote_type:"Highway Construction"}})[e.currentStepType]),e.processClaudeResponse(r)}catch(t){console.error("Error processing answer:",t),e.setCurrentQuestion("Sorry, there was an error processing your response. Please try again.")}finally{e.setIsLoading(!1)}}catch(t){console.error("Error in answer handling:",t),e.setCurrentQuestion("Sorry, there was an error. Please try again or toggle the Claude API switch."),e.setIsLoading(!1)}}};return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Adaptive Quote Request Flow"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Get a customized quote for heavy construction materials by answering a series of questions."})]})}),(0,a.jsxs)("div",{className:"mt-4 flex items-center",children:[(0,a.jsx)(o,{enabled:e.useClaudeAPI,onChange:t=>e.setUseClaudeAPI(t)}),(0,a.jsx)("span",{className:"ml-6",children:(0,a.jsx)(c,{})})]})]}),e.quoteComplete?(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"p-8 bg-white dark:bg-gray-800 rounded-lg shadow-md transition-colors duration-200",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-8 h-8",children:[(0,a.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,a.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Quote Request Submitted"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Your quote request has been successfully generated!"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Quote ID: ",(0,a.jsx)("span",{className:"font-mono font-medium",children:e.quoteRequest.id||"QR-123456"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Created: ",e.quoteRequest.createdAt?new Date(e.quoteRequest.createdAt).toLocaleDateString():new Date().toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex justify-center mt-8 space-x-4",children:[(0,a.jsx)("button",{onClick:()=>e.resetStore(),className:"px-6 py-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:"Start New Quote"}),(0,a.jsx)(n(),{href:"/",className:"px-6 py-3 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:"Return Home"}),(0,a.jsx)(n(),{href:"/prototype-13/track?id=".concat(e.quoteRequest.id||"QR-123456"),className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Track Order"})]})]})}),(0,a.jsx)("div",{className:"lg:w-96 w-full mt-8 lg:mt-0",children:(0,a.jsx)(p.A,{quoteRequest:e.quoteRequest})})]}):(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(g,{currentQuestion:e.currentQuestion,onAnswer:t,onPrevious:()=>{e.goToPreviousQuestion()},isLoading:e.isLoading,stepType:e.currentStepType,materials:e.recommendedMaterials,plants:e.recommendedPlants,hasPrevious:e.questionHistory.length>0})}),(0,a.jsx)("div",{className:"lg:w-96 w-full mt-8 lg:mt-0",children:(0,a.jsx)(p.A,{quoteRequest:e.quoteRequest})})]})]})})}},e=>{var t=t=>e(e.s=t);e.O(0,[866,6874,3438,6881,849,8441,1684,7358],()=>t(3639)),_N_E=e.O()}]);